<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Quickstart - Nebulo</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Quickstart";
    var mkdocs_page_input_path = "quickstart.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Nebulo</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <p class="caption"><span class="caption-text">Welcome</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="..">Introduction</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Quickstart</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#database-setup">Database Setup</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#graphql-schema">GraphQL Schema</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#query-the-api">Query the API</a>
    </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Feature Support</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../supported_types/">Types</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../supported_entities/">Entities</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Examples</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../sqlalchemy_interop/">SQLAlchemy Interop</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Advanced</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../authentication/">Authentication</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../performance/">Performance</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Nebulo</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Welcome &raquo;</li>
        
      
    
    <li>Quickstart</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/olirice/nebulo/edit/master/docs/quickstart.md"> Edit on olirice/nebulo</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="quickstart">Quickstart</h2>
<p>For this example we're going to create a simple blogging platform. We'll start by creating a minimal database schema. Then we'll use nebulo to reflect our GraphQL API. Finally, we'll query from that API.</p>
<h3 id="installation">Installation</h3>
<p>Requires: Python 3.7+</p>
<div class="shell codehilite"><pre><span></span><code>pip install nebulo
</code></pre></div>

<h3 id="database-setup">Database Setup</h3>
<p>If you don't have PostgreSQL installed locally, the following docker command creates an instance with the connection string used for the remainder of the quickstart guide.</p>
<div class="shell codehilite"><pre><span></span><code>docker run --rm --name nebulo_demo -p <span class="m">4443</span>:5432 -d -e <span class="nv">POSTGRES_DB</span><span class="o">=</span>nebulo_db -e <span class="nv">POSTGRES_PASSWORD</span><span class="o">=</span>password -e <span class="nv">POSTGRES_USER</span><span class="o">=</span>nebulo_user -d postgres
</code></pre></div>

<p>Next, we need to define our database schema. We need a table for accounts, and another for blog posts. All blog posts must be associated with an author in the accounts table. Additionally, we don't want to allow users to update or delete their blog post.</p>
<div class="sql codehilite"><pre><span></span><code><span class="c1">-- blog_schema.sql</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="k">public</span><span class="p">.</span><span class="n">account</span> <span class="p">(</span>
    <span class="n">id</span> <span class="nb">SERIAL</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
    <span class="n">name</span> <span class="nb">TEXT</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="n">created_at</span> <span class="k">TIMESTAMP</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">DEFAULT</span> <span class="n">now</span><span class="p">()</span>
<span class="p">);</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="k">public</span><span class="p">.</span><span class="n">blog_post</span> <span class="p">(</span>
    <span class="n">id</span> <span class="nb">SERIAL</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
    <span class="n">title</span> <span class="nb">TEXT</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="n">body</span> <span class="nb">TEXT</span><span class="p">,</span>
    <span class="n">author_id</span> <span class="nb">INT</span> <span class="k">REFERENCES</span> <span class="n">account</span><span class="p">(</span><span class="n">id</span><span class="p">),</span>
    <span class="n">created_at</span> <span class="k">TIMESTAMP</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">DEFAULT</span> <span class="n">now</span><span class="p">()</span>
<span class="p">);</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">account</span> <span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="k">VALUES</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Oliver&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Buddy&#39;</span><span class="p">);</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">blog_post</span> <span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">author_id</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span> <span class="k">VALUES</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;First Post&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Sanitize all the things!&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;To Bite or not to Bite&#39;</span><span class="p">);</span>


<span class="k">COMMENT</span> <span class="k">ON</span> <span class="k">TABLE</span> <span class="n">blog_post</span> <span class="k">IS</span> <span class="n">E</span><span class="s1">&#39;@exclude update, delete&#39;</span><span class="p">;</span>
</code></pre></div>

<p>Note the comment to exclude updates and deletes from blog posts. The same comment format can also be applied to exclude columns from reflection e.g. password hashes.</p>
<h3 id="graphql-schema">GraphQL Schema</h3>
<p>Now we're ready to reflect the database schema into a GraphQL schema. The GraphQL schema document describes our API's types, fields, and relationships between entities. If you're new to GraphQL check out their <a href="https://graphql.org/learn/">documentation</a> for more information.</p>
<p>To inspect the GraphQL schema</p>
<div class="shell codehilite"><pre><span></span><code>neb dump-schema -c postgresql://nebulo_user:password@localhost:4443/nebulo_db
</code></pre></div>

<p>where the connection string provided by <code>-c</code> is in the format <code>postgresql://&lt;user&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;/&lt;database_name&gt;</code></p>
<p>Which outputs the schema below</p>
<div class="graphql codehilite"><pre><span></span><code><span class="kt">type</span> <span class="k">Query</span> <span class="p">{</span>
  <span class="c c-Multi">&quot;&quot;&quot;Reads a single Account using its globally unique ID&quot;&quot;&quot;</span>
  <span class="k">account</span><span class="p">(</span>nodeId: <span class="k">ID</span><span class="p">!):</span> <span class="k">Account</span>

  <span class="c c-Multi">&quot;&quot;&quot;Reads and enables pagination through a set of Account&quot;&quot;&quot;</span>
  <span class="k">allAccounts</span><span class="p">(</span>first: <span class="k">Int</span>, last: <span class="k">Int</span>, before: <span class="k">Cursor</span>, after: <span class="k">Cursor</span>, condition: <span class="k">accountCondition</span><span class="p">):</span> <span class="k">AccountConnection</span>

  <span class="c c-Multi">&quot;&quot;&quot;Reads a single BlogPost using its globally unique ID&quot;&quot;&quot;</span>
  <span class="k">blogPost</span><span class="p">(</span>nodeId: <span class="k">ID</span><span class="p">!):</span> <span class="k">BlogPost</span>

  <span class="c c-Multi">&quot;&quot;&quot;Reads and enables pagination through a set of BlogPost&quot;&quot;&quot;</span>
  <span class="k">allBlogPosts</span><span class="p">(</span>first: <span class="k">Int</span>, last: <span class="k">Int</span>, before: <span class="k">Cursor</span>, after: <span class="k">Cursor</span>, condition: <span class="k">blogPostCondition</span><span class="p">):</span> <span class="k">BlogPostConnection</span>
<span class="p">}</span>

<span class="kt">type</span> <span class="k">Mutation</span> <span class="p">{</span>
  <span class="c c-Multi">&quot;&quot;&quot;Creates a single Account.&quot;&quot;&quot;</span>
  <span class="k">createAccount</span><span class="p">(</span>input: <span class="k">CreateAccountInput</span><span class="p">!):</span> <span class="k">CreateAccountPayload</span>

  <span class="c c-Multi">&quot;&quot;&quot;Updates a single Account using its globally unique id and a patch.&quot;&quot;&quot;</span>
  <span class="k">updateAccount</span><span class="p">(</span>input: <span class="k">UpdateAccountInput</span><span class="p">!):</span> <span class="k">UpdateAccountPayload</span>

  <span class="c c-Multi">&quot;&quot;&quot;Delete a single Account using its globally unique id and a patch.&quot;&quot;&quot;</span>
  <span class="k">deleteAccount</span><span class="p">(</span>input: <span class="k">DeleteAccountInput</span><span class="p">!):</span> <span class="k">DeleteAccountPayload</span>

  <span class="c c-Multi">&quot;&quot;&quot;Creates a single BlogPost.&quot;&quot;&quot;</span>
  <span class="k">createBlogPost</span><span class="p">(</span>input: <span class="k">CreateBlogPostInput</span><span class="p">!):</span> <span class="k">CreateBlogPostPayload</span>
<span class="p">}</span>

<span class="kt">type</span> <span class="k">Account</span> <span class="kt">implements</span> <span class="k">NodeInterface</span> <span class="p">{</span>
  nodeId: <span class="k">ID</span><span class="p">!</span>
  id: <span class="k">Int</span><span class="p">!</span>
  name: <span class="k">String</span><span class="p">!</span>
  createdAt: <span class="k">DateTime</span><span class="p">!</span>

  <span class="c c-Multi">&quot;&quot;&quot;Reads and enables pagination through a set of BlogPost&quot;&quot;&quot;</span>
  <span class="k">blogPostsByIdToAuthorId</span><span class="p">(</span>first: <span class="k">Int</span>, last: <span class="k">Int</span>, before: <span class="k">Cursor</span>, after: <span class="k">Cursor</span>, condition: <span class="k">blogPostCondition</span><span class="p">):</span> <span class="k">BlogPostConnection</span><span class="p">!</span>
<span class="p">}</span>

<span class="c c-Multi">&quot;&quot;&quot;An object with a nodeId&quot;&quot;&quot;</span>
<span class="kt">interface</span> <span class="k">NodeInterface</span> <span class="p">{</span>
  <span class="c c-Multi">&quot;&quot;&quot;The global id of the object.&quot;&quot;&quot;</span>
  nodeId: <span class="k">ID</span><span class="p">!</span>
<span class="p">}</span>

<span class="k">scalar</span> <span class="k">DateTime</span>

<span class="kt">type</span> <span class="k">BlogPostConnection</span> <span class="p">{</span>
  edges: <span class="p">[</span><span class="k">BlogPostEdge</span><span class="p">!]!</span>
  pageInfo: <span class="k">PageInfo</span><span class="p">!</span>
  totalCount: <span class="k">Int</span><span class="p">!</span>
<span class="p">}</span>

<span class="kt">type</span> <span class="k">BlogPostEdge</span> <span class="p">{</span>
  cursor: <span class="k">Cursor</span>
  node: <span class="k">BlogPost</span>
<span class="p">}</span>

<span class="k">scalar</span> <span class="k">Cursor</span>


<span class="err">&lt;</span><span class="k">abridged</span> <span class="k">output</span><span class="err">&gt;</span>
</code></pre></div>

<p>Notice that our API detected the foreign key relationship between <code>Account</code> and <code>BlogPost</code> and created <code>blogPostsByIdToAuthorId</code> and <code>accountByAuthorIdToId</code> on their base types respectively.</p>
<h3 id="query-the-api">Query the API</h3>
<p>To start the API server, execute <code>neb run</code> passing in a connection to the database.</p>
<div class="shell codehilite"><pre><span></span><code>neb run -c postgresql://nebulo_user:password@localhost:4443/nebulo_db
</code></pre></div>

<p>In addition to handling GraphQL requests, nebulo also serves the <a href="https://github.com/graphql/graphiql">GraphiQL explorer</a> locally at <a href="http://localhost:5034/graphiql">http://localhost:5034/graphiql</a>.</p>
<p><img alt="graphiql image" src="../images/graphiql.png" /></p>
<p>Enter your query in GraphiQL and click the arrow icon to execute it.</p>
<p>You're all done!</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../supported_types/" class="btn btn-neutral float-right" title="Types">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href=".." class="btn btn-neutral" title="Introduction"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href=".." style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../supported_types/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
